version: 1.11.0
pack_type: rust_audit_general_set6
engine: rsqt
response_schema: '--- REQUIRED OUTPUT FORMAT ---

  MANDATORY FIRST LINES (must be the first two lines of your response; copy exactly):

  VERDICT=TRUE_POSITIVE|FALSE_POSITIVE|INDETERMINATE

  CITATIONS=path:line(-line), path:line(-line), ...


  After those two lines, write the answer body.


  Hard bans:

  - Do NOT output Markdown section headers like "Analysis:" or "CITATIONS:".

  - Do NOT invent line numbers or file paths. Only cite tokens that appear in the evidence (including artifact anchors like
  *.json:1).

  - Do NOT include VERDICT or CITATIONS anywhere else in the body.


  Policy:

  - If a claim cannot be proven from extracted evidence, set VERDICT=INDETERMINATE and say "INSUFFICIENT EVIDENCE" + list
  what is missing.

  - Prefer deterministic extraction evidence; do NOT speculate.

  '
defaults:
  chat_top_k: 12
  max_tokens: 2000
  temperature: 0.0
questions:
- id: R_META_1
  title: Workspace Proof Files Present
  category: meta
  top_k: 8
  answer_mode: deterministic
  advice_mode: llm
  question: 'RESPONSE FORMAT: You MUST start with VERDICT= and CITATIONS= as specified in the pack RESPONSE FORMAT.


    Inventory proof files present in the indexed corpus.

    You MUST paste the exact file paths from evidence. Do NOT write placeholders like "(list all paths found)".


    List:

    - All Cargo.toml file paths (paste each path from evidence, e.g. crates/engine/Cargo.toml)

    - Cargo.lock path (if present in evidence)

    - rust-toolchain.toml path (if present in evidence)

    '
  preflight:
  - name: cargo_toml_files
    cmd:
    - query
    - --file
    - Cargo.toml
    - --include-all-files
    - --columns
    - file_path
    - total_lines
    - --limit
    - '20'
    - --format
    - json
  - name: cargo_lock
    cmd:
    - query
    - --file
    - Cargo.lock
    - --include-all-files
    - --columns
    - file_path
    - total_lines
    - --limit
    - '5'
    - --format
    - json
  - name: toolchain
    cmd:
    - query
    - --file
    - rust-toolchain
    - --include-all-files
    - --columns
    - file_path
    - total_lines
    - --limit
    - '5'
    - --format
    - json
  expected_verdict: TRUE_POSITIVE
- id: R_API_3
  title: Public Re-exports (pub use)
  category: api_coverage
  top_k: 10
  answer_mode: deterministic
  advice_mode: llm
  question: "RESPONSE FORMAT: You MUST start with VERDICT= and CITATIONS= as specified in the pack RESPONSE FORMAT.\n\nIdentify\
    \ public re-exports via `pub use`.\n\nQuote each `pub use` statement from the evidence below, one per line,\nwith its\
    \ file:line citation. Include at least the first 20 results.\n\nOutput format (one per line):\n  pub use crate::module::{Type1,\
    \ Type2};  // file.rs:NN\n\nDo NOT just say \"listed above\" - you MUST repeat each pub use line in your answer.\n"
  preflight:
  - name: pub_use_hits
    cmd:
    - search
    - 'pub use '
    - --limit
    - '80'
    - --format
    - json
    transform:
      render: lines
  expected_verdict: TRUE_POSITIVE
- id: R_DOC_UNDOC_1
  title: Undocumented Public API Examples (Bounded)
  category: documentation
  top_k: 10
  answer_mode: deterministic
  advice_mode: llm
  question: "MANDATORY FIRST LINES (write these two lines first, before any list; copy exactly):\nVERDICT=TRUE_POSITIVE|FALSE_POSITIVE|INDETERMINATE\n\
    CITATIONS=path:line(-line), path:line(-line), ...\n\nTask: List up to 10 undocumented public items (visibility=pub) from\
    \ the structured evidence.\nUse DOC_SUMMARY counts; do not claim repo-global totals beyond DOC_SUMMARY.\n\nOutput format\
    \ (exact; ONE line per item; keep each line short):\n1. <signature-or-name> \u2014 <path:line> \u2014 undocumented (doc.has_doc=false)\n\
    \nRules:\n- Max 10 items. If fewer exist, list all shown.\n- Do NOT add prose paragraphs. No sub-bullets.\n- Always include\
    \ at least one <path:line> per item (from evidence).\n- Even if you think evidence is insufficient, still output VERDICT\
    \ and CITATIONS (first lines already written).\n"
  preflight:
  - name: doc_analysis
    cmd:
    - docs
    - --format
    - json
    transform:
      render: list
      max_items: 50
      max_chars: 16000
  expected_verdict: TRUE_POSITIVE
- id: R_CARGO_2
  title: Feature Definitions and Feature Usage
  category: cargo
  top_k: 12
  answer_mode: deterministic
  advice_mode: llm
  question: 'RESPONSE FORMAT: You MUST start with VERDICT= and CITATIONS= as specified in the pack RESPONSE FORMAT.


    Inventory Cargo features:

    A) crate-defined [features] blocks (may be none)

    B) dependency feature usage lines (features = [...], default-features = false)


    Quote feature blocks/lines; do not invent.

    '
  preflight:
  - name: features_blocks
    cmd:
    - query
    - --file
    - Cargo.toml
    - --contains
    - '[features]'
    - --include-all-files
    - --columns
    - file_path
    - line_start
    - line_end
    - source_text
    - --limit
    - '200'
    - --format
    - json
    render: block
    fence_lang: toml
    block_max_chars: 8000
  - name: dep_features_hits
    cmd:
    - search
    - features = [
    - --include-all-files
    - --limit
    - '200'
    - --format
    - json
  - name: default_features_hits
    cmd:
    - search
    - default-features
    - --include-all-files
    - --limit
    - '200'
    - --format
    - json
  expected_verdict: TRUE_POSITIVE
validation:
  required_verdicts:
  - TRUE_POSITIVE
  - FALSE_POSITIVE
  - INDETERMINATE
  citation_format: path:line(-line)
  fail_on_missing_citations: true
  enforce_citations_from_evidence: true
  enforce_no_new_paths: true
  enforce_paths_must_be_cited: true
  minimum_questions: 4
runner:
  plugin: rsqt_guru
  plugin_config:
    rules_path: cfg_rust_audit_rsqt_general_finding_rules.yaml
    question_validators_path: cfg_rust_audit_rsqt_general_question_validators.yaml
